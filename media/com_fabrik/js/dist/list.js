/*! Fabrik */
define(["jquery","fab/fabrik","fab/list-toggle","fab/list-grouped-toggler","fab/list-keys","fab/list-actions","fab/mootools-ext"],function(a,b,c,d,e,f){var g=new Class({Implements:[Options,Events],actionManager:null,options:{admin:!1,filterMethod:"onchange",ajax:!1,ajax_links:!1,links:{edit:"",detail:"",add:""},form:"listform_"+this.id,hightLight:"#ccffff",primaryKey:"",headings:[],labels:{},Itemid:0,formid:0,canEdit:!0,canView:!0,page:"index.php",actionMethod:"floating",formels:[],data:[],itemTemplate:"",floatPos:"left",csvChoose:!1,csvOpts:{excel:!1,incfilters:!1,inctabledata:!1,incraw:!1,inccalcs:!1},popup_width:300,popup_height:300,popup_offset_x:null,popup_offset_y:null,groupByOpts:{},isGrouped:!1,listRef:"",fabrik_show_in_list:[],singleOrdering:!1,tmpl:"",groupedBy:"",toggleCols:!1},initialize:function(a,g){this.id=a,this.setOptions(g),this.getForm(),this.result=!0,this.plugins=[],this.list=document.id("list_"+this.options.listRef),this.options.j3===!1&&(this.actionManager=new f(this,{method:this.options.actionMethod,floatPos:this.options.floatPos})),this.options.toggleCols&&(this.toggleCols=new c(this.form)),this.groupToggle=new d(this.form,this.options.groupByOpts),new e(this),this.list&&("table"===this.list.get("tag")&&(this.tbody=this.list.getElement("tbody")),"null"===typeOf(this.tbody)&&(this.tbody=this.list),window.ie&&(this.options.itemTemplate=this.list.getElement(".fabrik_row"))),this.watchAll(!1),b.addEvent("fabrik.form.submitted",function(){this.updateRows()}.bind(this)),!this.options.resetFilters&&window.history&&history.pushState&&history.state&&this.options.ajax&&this._updateRows(history.state),b.fireEvent("fabrik.list.loaded",[this])},setItemTemplate:function(){if("string"===typeOf(this.options.itemTemplate)){var a=this.list.getElement(".fabrik_row");window.ie&&"null"!==typeOf(a)&&(this.options.itemTemplate=a)}},rowClicks:function(){this.list.addEvent("click:relay(.fabrik_row)",function(a,c){var d=Array.from(c.id.split("_")),e={};e.rowid=d.getLast();var f={errors:{},data:e,rowid:d.getLast(),listid:this.id};b.fireEvent("fabrik.list.row.selected",f)}.bind(this))},watchAll:function(a){a=a?a:!1,this.watchNav(),this.storeCurrentValue(),a||(this.watchRows(),this.watchFilters()),this.watchOrder(),this.watchEmpty(),a||(this.watchGroupByMenu(),this.watchButtons())},watchGroupByMenu:function(){this.options.ajax&&this.form.addEvent("click:relay(*[data-groupBy])",function(a,b){this.options.groupedBy=b.get("data-groupBy"),a.rightClick||(a.preventDefault(),this.updateRows())}.bind(this))},watchButtons:function(){this.exportWindowOpts={modalId:"exportcsv",type:"modal",id:"exportcsv",title:"Export CSV",loadMethod:"html",minimizable:!1,width:360,height:240,content:"",modal:!0,bootstrap:this.options.j3},"csv"===this.options.view?this.openCSVWindow():this.form.getElements(".csvExportButton")&&this.form.getElements(".csvExportButton").each(function(a){a.hasClass("custom")===!1&&a.addEvent("click",function(a){this.openCSVWindow(),a.stop()}.bind(this))}.bind(this))},openCSVWindow:function(){var c=this;this.exportWindowOpts.content=this.makeCSVExportForm(),this.csvWindow=b.getWindow(this.exportWindowOpts),a(".exportCSVButton").on("click",function(b){b.stopPropagation(),this.disabled=!0;var d=a("#csvmsg");0===d.length&&(d=a("<div />").attr({id:"csvmsg"}).insertBefore(a(this))),d.html(Joomla.JText._("COM_FABRIK_LOADING")+' <br /><span id="csvcount">0</span> / <span id="csvtotal"></span> '+Joomla.JText._("COM_FABRIK_RECORDS")+".<br/>"+Joomla.JText._("COM_FABRIK_SAVING_TO")+'<span id="csvfile"></span>'),c.triggerCSVExport(0)})},makeCSVExportForm:function(){return this.options.csvChoose?(this.csvExportForm=this._csvExportForm(),this.csvExportForm):this._csvAutoStart()},_csvAutoStart:function(){var b=a("<div />").attr({id:"csvmsg"}).html(Joomla.JText._("COM_FABRIK_LOADING")+' <br /><span id="csvcount">0</span> / <span id="csvtotal"></span> '+Joomla.JText._("COM_FABRIK_RECORDS")+".<br/>"+Joomla.JText._("COM_FABRIK_SAVING_TO")+'<span id="csvfile"></span>');return this.csvopts=this.options.csvOpts,this.csvfields=this.options.csvFields,this.triggerCSVExport(-1),b},_csvYesNo:function(b,c,d,e,f){var g=a("<label />").css("float","left"),h=g.clone().append([a("<input />").attr({type:"radio",name:b,value:"1",checked:c}),a("<span />").text(d)]),i=g.clone().append([a("<input />").attr({type:"radio",name:b,value:"0",checked:!c}),a("<span />").text(e)]),j=a("<div>").css({width:"200px","float":"left"}).text(f);return a("<div>").append([j,h,i])},_csvExportForm:function(){var b=Joomla.JText._("JYES"),c=Joomla.JText._("JNO"),d=this,e="index.php?option=com_fabrik&view=list&listid="+this.id+"&format=csv&Itemid="+this.options.Itemid,f=(a("<label />").css("float","left"),a("<form />").attr({action:e,method:"post"}).append([this._csvYesNo("excel",this.options.csvOpts.excel,"Excel CSV","CSV",Joomla.JText._("COM_FABRIK_FILE_TYPE")),this._csvYesNo("incfilters",this.options.csvOpts.incfilters,b,c,Joomla.JText._("COM_FABRIK_INCLUDE_FILTERS")),this._csvYesNo("inctabledata",this.options.csvOpts.inctabledata,b,c,Joomla.JText._("COM_FABRIK_INCLUDE_DATA")),this._csvYesNo("incraw",this.options.csvOpts.incraw,b,c,Joomla.JText._("COM_FABRIK_INCLUDE_RAW_DATA")),this._csvYesNo("inccalcs",this.options.csvOpts.inccalcs,b,c,Joomla.JText._("COM_FABRIK_INCLUDE_CALCULATIONS"))]));a("<h4 />").css("clear","left").text(Joomla.JText._("COM_FABRIK_SELECT_COLUMNS_TO_EXPORT")).appendTo(f);var g="",h=0;return a.each(this.options.labels,function(e,i){if("fabrik_"!==e.substr(0,7)&&"____form_heading"!==e){var j=e.split("___")[0];j!==g&&(g=j,a("<h5 />").text(g).appendTo(f)),i=i.replace(/<\/?[^>]+(>|jQuery)/g,""),d._csvYesNo("fields["+e+"]",!0,b,c,i).appendTo(f)}h++}),this.options.formels.length>0&&(a("<h5 />").css("clear","left").text(Joomla.JText._("COM_FABRIK_FORM_FIELDS")).appendTo(f),this.options.formels.each(function(a){d._csvYesNo("fields["+a.name+"]",!1,b,c,a.label).appendTo(f)})),a("<input />").attr({type:"hidden",name:"view",value:"table"}).appendTo(f),a("<input />").attr({type:"hidden",name:"option",value:"com_fabrik"}).appendTo(f),a("<input />").attr({type:"hidden",name:"listid",value:d.id}).appendTo(f),a("<input />").attr({type:"hidden",name:"format",value:"csv"}).appendTo(f),a("<input />").attr({type:"hidden",name:"c",value:"table"}).appendTo(f),f},triggerCSVExport:function(c,d,e){var f=this;0!==c?-1===c?(c=0,d=f.csvopts,d.fields=f.csvfields):(d=f.csvopts,e=f.csvfields):(d||(d={},["incfilters","inctabledata","incraw","inccalcs","excel"].each(function(a){var b=f.csvExportForm.find("input[name="+a+"]");b.length>0&&(d[a]=b.filter(function(){return this.checked})[0].value)})),e||(e={},f.csvExportForm.find("input[name^=field]").each(function(){if(this.checked){var b=this.name.replace("fields[","").replace("]","");e[b]=a(this).val()}})),d.fields=e,f.csvopts=d,f.csvfields=e),d=this.csvExportFilterOpts(d),d.start=c,d.option="com_fabrik",d.view="list",d.format="csv",d.Itemid=this.options.Itemid,d.listid=this.id,d.listref=this.options.listRef,d.download=0,d.setListRefFromRequest=1,this.options.csvOpts.custom_qs.split("&").each(function(a){var b=a.split("=");d[b[0]]=b[1]});var g=new Request.JSON({url:"?"+this.options.csvOpts.custom_qs,method:"post",data:d,onError:function(a,b){fconsole(a,b)},onComplete:function(c){if(c.err)window.alert(c.err),b.Windows.exportcsv.close();else if(a("#csvcount").text(c.count),a("#csvtotal").text(c.total),a("#csvfile").text(c.file),c.count<c.total)this.triggerCSVExport(c.count);else{var d="index.php?option=com_fabrik&view=list&format=csv&listid="+this.id+"&start="+c.count+"&Itemid="+this.options.Itemid,e='<div class="alert alert-success"><h3>'+Joomla.JText._("COM_FABRIK_CSV_COMPLETE");e+='</h3><p><a class="btn btn-success" href="'+d+'"><i class="icon-download"></i> '+Joomla.JText._("COM_FABRIK_CSV_DOWNLOAD_HERE")+"</a></p></div>",a("#csvmsg").html(e),this.csvWindow.fitToContent(!1),this.csvWindow.center(),document.getElements("input.exportCSVButton").removeProperty("disabled"),a("#csvmsg a.btn-success").focusout(function(){b.Windows.exportcsv.close(!0)})}}.bind(this)});g.send()},csvExportFilterOpts:function(a){var b,c,d,e,f=0,g=0,h=["value","condition","join","key","search_type","match","full_words_only","eval","grouped_to_previous","hidden","elementid"];return this.getFilters().each(function(b){c=b.name.split("["),c.length>3&&(e=c[3].replace("]","").toInt(),f=e>f?e:f,"checkbox"===b.get("type")||"radio"===b.get("type")?b.checked&&(a[b.name]=b.get("value")):a[b.name]=b.get("value"))}.bind(this)),f++,Object.each(this.options.advancedFilters,function(c,e){if(h.contains(e))for(g=0,b=0;b<c.length;b++)g=b+f,d="fabrik___filter[list_"+this.options.listRef+"]["+e+"]["+g+"]",a[d]="value"===e?this.options.advancedFilters.origvalue[b]:"condition"===e?this.options.advancedFilters.orig_condition[b]:c[b]}.bind(this)),a},addPlugins:function(a){a.each(function(a){a.list=this}.bind(this)),this.plugins=a},firePlugin:function(a){var c=Array.prototype.slice.call(arguments);return c=c.slice(1,c.length),this.plugins.each(function(){b.fireEvent(a,[this,c])}.bind(this)),this.result===!1?!1:!0},watchEmpty:function(){var a=document.id(this.options.form).getElement(".doempty");a&&a.addEvent("click",function(a){a.stop(),window.confirm(Joomla.JText._("COM_FABRIK_CONFIRM_DROP"))&&this.submit("list.doempty")}.bind(this))},watchOrder:function(){var a=!1,c=document.id(this.options.form).getElements(".fabrikorder, .fabrikorder-asc, .fabrikorder-desc");c.removeEvents("click"),c.each(function(c){c.addEvent("click",function(d){var e="ordernone.png",f="",g="",h="",i="";c=document.id(d.target);var j=c.getParent(".fabrik_ordercell");switch("a"!==c.tagName&&(c=j.getElement("a")),c.className){case"fabrikorder-asc":g="fabrikorder-desc",h=c.get("data-sort-desc-icon"),i=c.get("data-sort-asc-icon"),f="desc",e="orderdesc.png";break;case"fabrikorder-desc":g="fabrikorder",h=c.get("data-sort-icon"),i=c.get("data-sort-desc-icon"),f="-",e="ordernone.png";break;case"fabrikorder":g="fabrikorder-asc",h=c.get("data-sort-asc-icon"),i=c.get("data-sort-icon"),f="asc",e="orderasc.png"}if(j.className.split(" ").each(function(b){b.contains("_order")&&(a=b.replace("_order","").replace(/^\s+/g,"").replace(/\s+$/g,""))}),!a)return void fconsole("woops didnt find the element id, cant order");c.className=g;var k=c.getElement("img"),l=c.firstElementChild;this.options.singleOrdering&&document.id(this.options.form).getElements(".fabrikorder, .fabrikorder-asc, .fabrikorder-desc").each(function(a){if(b.bootstrapped){var c=a.firstElementChild;switch(a.className){case"fabrikorder-asc":c.removeClass(a.get("data-sort-asc-icon")),c.addClass(a.get("data-sort-icon"));break;case"fabrikorder-desc":c.removeClass(a.get("data-sort-desc-icon")),c.addClass(a.get("data-sort-icon"));break;case"fabrikorder":}}else{var d=a.getElement("img");d&&(d.src=d.src.replace("ordernone.png","").replace("orderasc.png","").replace("orderdesc.png",""),d.src+="ordernone.png")}}),b.bootstrapped?(l.removeClass(i),l.addClass(h)):k&&(k.src=k.src.replace("ordernone.png","").replace("orderasc.png","").replace("orderdesc.png",""),k.src+=e),this.fabrikNavOrder(a,f),d.stop()}.bind(this))}.bind(this))},getFilters:function(){return document.id(this.options.form).getElements(".fabrik_filter")},storeCurrentValue:function(){this.getFilters().each(function(a){"submitform"!==this.options.filterMethod&&a.store("initialvalue",a.get("value"))}.bind(this))},watchFilters:function(){var a="",b=document.id(this.options.form).getElements(".fabrik_filter_submit");this.getFilters().each(function(c){a="select"===c.get("tag")?"change":"blur","submitform"!==this.options.filterMethod?(c.removeEvent(a),c.addEvent(a,function(a){a.stop(),a.target.retrieve("initialvalue")!==a.target.get("value")&&this.doFilter()}.bind(this))):c.addEvent(a,function(){b.highlight("#ffaa00")}.bind(this))}.bind(this)),b&&(b.removeEvents(),b.addEvent("click",function(a){a.stop(),this.doFilter()}.bind(this))),this.getFilters().addEvent("keydown",function(a){13===a.code&&(a.stop(),this.doFilter())}.bind(this))},doFilter:function(){var a=b.fireEvent("list.filter",[this]).eventResults;"null"===typeOf(a)&&this.submit("list.filter"),0!==a.length&&a.contains(!1)||this.submit("list.filter")},setActive:function(a){this.list.getElements(".fabrik_row").each(function(a){a.removeClass("activeRow")}),a.addClass("activeRow")},getActiveRow:function(a){var c=a.target.getParent(".fabrik_row");return c||(c=b.activeRow),c},watchRows:function(){this.list&&this.rowClicks()},getForm:function(){return this.form||(this.form=document.id(this.options.form)),this.form},uncheckAll:function(){this.form.getElements("input[name^=ids]").each(function(a){a.checked=""})},submit:function(a){this.getForm();var c=this.options.ajax;if("list.doPlugin.noAJAX"===a&&(a="list.doPlugin",c=!1),"list.delete"===a){var d=!1,e=0;if(this.form.getElements("input[name^=ids]").each(function(a){a.checked&&(e++,d=!0)}),!d)return window.alert(Joomla.JText._("COM_FABRIK_SELECT_ROWS_FOR_DELETION")),b.loader.stop("listform_"+this.options.listRef),!1;var f=1===e?Joomla.JText._("COM_FABRIK_CONFIRM_DELETE_1"):Joomla.JText._("COM_FABRIK_CONFIRM_DELETE").replace("%s",e);if(!window.confirm(f))return b.loader.stop("listform_"+this.options.listRef),this.uncheckAll(),!1}if("list.filter"===a?(b["filter_listform_"+this.options.listRef].onSubmit(),this.form.task.value=a,this.form["limitstart"+this.id]&&(this.form.getElement("#limitstart"+this.id).value=0)):""!==a&&(this.form.task.value=a),c){b.loader.start("listform_"+this.options.listRef),this.form.getElement("input[name=option]").value="com_fabrik",this.form.getElement("input[name=view]").value="list",this.form.getElement("input[name=format]").value="raw";var g=this.form.toQueryString();if("list.doPlugin"===a&&(g+="&setListRefFromRequest=1",g+="&listref="+this.options.listRef),"list.filter"===a&&this.advancedSearch!==!1){var h=document.getElement("form.advancedSearch_"+this.options.listRef);"null"!==typeOf(h)&&(g+="&"+h.toQueryString(),g+="&replacefilters=1")}for(var i=0;i<this.options.fabrik_show_in_list.length;i++)g+="&fabrik_show_in_list[]="+this.options.fabrik_show_in_list[i];g+="&tmpl="+this.options.tmpl,this.request?this.request.options.data=g:this.request=new Request({url:this.form.get("action"),data:g,onComplete:function(a){a=JSON.decode(a),this._updateRows(a),b.loader.stop("listform_"+this.options.listRef),b["filter_listform_"+this.options.listRef].onUpdateData(),b.fireEvent("fabrik.list.submit.ajax.complete",[this,a]),a.msg&&window.alert(a.msg)}.bind(this)}),this.request.send(),window.history&&window.history.pushState&&history.pushState(g,"fabrik.list.submit"),b.fireEvent("fabrik.list.submit",[a,this.form.toQueryString().toObject()])}else this.form.submit();return!1},fabrikNav:function(a){return this.options.limitStart=a,this.form.getElement("#limitstart"+this.id).value=a,b.fireEvent("fabrik.list.navigate",[this,a]),this.result?(this.submit("list.view"),!1):(this.result=!0,!1)},getRowIds:function(){var a=[],b=this.options.isGrouped?$H(this.options.data):this.options.data;return b.each(function(b){b.each(function(b){a.push(b.data.__pk_val)})}),a},getRow:function(a){var b={};return Object.each(this.options.data,function(c){for(var d=0;d<c.length;d++){var e=c[d];e&&e.data.__pk_val===a&&(b=e.data)}}),b},fabrikNavOrder:function(a,c){return this.form.orderby.value=a,this.form.orderdir.value=c,b.fireEvent("fabrik.list.order",[this,a,c]),this.result?void this.submit("list.order"):(this.result=!0,!1)},removeRows:function(a){var b;for(b=0;b<a.length;b++){var c=document.id("list_"+this.id+"_row_"+a[b]),d=new Fx.Morph(c,{duration:1e3});d.start({backgroundColor:this.options.hightLight}).chain(function(){this.start({opacity:0})}).chain(function(){c.dispose(),this.checkEmpty()}.bind(this))}},editRow:function(){},clearRows:function(){this.list.getElements(".fabrik_row").each(function(a){a.dispose()})},updateRows:function(a){var b={option:"com_fabrik",view:"list",task:"list.view",format:"raw",listid:this.id,group_by:this.options.groupedBy,listref:this.options.listRef},c="";b["limit"+this.id]=this.options.limitLength,a&&Object.append(b,a),new Request({url:c,data:b,evalScripts:!1,onSuccess:function(a){a=a.stripScripts(),a=JSON.decode(a),this._updateRows(a)}.bind(this),onError:function(a,b){fconsole(a,b)},onFailure:function(a){fconsole(a)}}).send()},_updateHeadings:function(b){var c=a("#"+this.options.form).find(".fabrik___heading").last(),d=new Hash(b.headings);d.each(function(a,b){b="."+b;try{c.find(b+" span").html(a)}catch(d){fconsole(d)}})},_updateGroupByTables:function(){var b,c=a(this.list).find("tbody");c.css("display",""),c.each(function(c,d){d.hasClass("fabrik_groupdata")||(b=a(d).next(),0===a(b).find(".fabrik_row").length&&(a(d).hide(),a(b).hide()))})},_updateRows:function(c){var d,e,f,g,h,i,j,k,l,m,n,o=[],p=a(this.form),q=this;if("object"===typeOf(c)&&(window.history&&window.history.pushState&&history.pushState(c,"fabrik.list.rows"),c.id===this.id&&"list"===c.model)){this._updateHeadings(c),this.setItemTemplate(),l=a(this.list).find(".fabrik_row").first(),"TR"===l.prop("tagName")?(i=l,h=1):(i=l.parent(),h=p.find(".fabrikDataContainer").data("cols")),h=void 0===h?1:h,k=i.clone().empty(),e=l.clone(),this.clearRows(),this.options.data=this.options.isGrouped?$H(c.data):c.data,c.calculations&&this.updateCals(c.calculations),p.find(".fabrikNav").html(c.htmlnav);var r=this.options.isGrouped||""!==this.options.groupedBy?$H(c.data):c.data,s=0;r.each(function(c){for(d=q.options.isGrouped?q.list.getElements(".fabrik_groupdata")[s]:q.tbody,d=a(d),d.empty(),q.options.isGrouped&&(g=d.prev(),g.find(".groupTitle").html(c[0].groupHeading)),o=[],s++,f=0;f<c.length;f++){var i=$H(c[f]);j=q.injectItemData(e,i),o.push(j)}for(o=b.Array.chunk(o,h),f=0;f<o.length;f++)m=o[f].length>0&&"TR"===o[f][0].prop("tagName")?o[f][0].children():o[f],n=k.clone().append(m),d.append(n)}),this._updateGroupByTables(),this._updateEmptyDataMsg(0===o.length),this.watchAll(!0),b.fireEvent("fabrik.list.updaterows"),b.fireEvent("fabrik.list.update",[this,c]),this.stripe(),this.mediaScan(),b.loader.stop("listform_"+this.options.listRef)}},_updateEmptyDataMsg:function(b){var c=a(this.list),d=c.parent(".fabrikDataContainer"),e=c.parent(".fabrikForm").find(".emptyDataMessage");b?(e.css("display",""),"none"===e.parent().css("display")&&e.parent().css("display",""),e.parent(".emptyDataMessage").css("display","")):(d.css("display",""),e.css("display","none"))},injectItemData:function(b,c){var d,e,f,g;if(a.each(c.data,function(a,c){e=b.find("."+a),"A"!==e.prop("tagName")?e.html(c):e.prop("href",c)}),b.find(".fabrik_row").prop("id",c.id),"string"==typeof this.options.itemTemplate){f=b.find(".fabrik_row"),f.prop("id",c.id);var h=c["class"].split(" ");for(g=0;g<h.length;g++)f.addClass(h[g]);d=b.clone()}else d=b.find(".fabrik_row");return d},mediaScan:function(){"undefined"!=typeof Slimbox&&Slimbox.scanPage(),"undefined"!=typeof Lightbox&&Lightbox.init(),"undefined"!=typeof Mediabox&&Mediabox.scanPage()},addRow:function(a){var b=new Element("tr",{"class":"oddRow1"});for(var c in a)if(-1!==this.options.headings.indexOf(c)){var d=new Element("td",{}).appendText(a[c]);b.appendChild(d)}b.inject(this.tbody)},addRows:function(a){var b,c;for(b=0;b<a.length;b++)for(c=0;c<a[b].length;c++)this.addRow(a[b][c]);this.stripe()},stripe:function(){var a,b=this.list.getElements(".fabrik_row");for(a=0;a<b.length;a++)if(!b[a].hasClass("fabrik___header")){var c="oddRow"+a%2;b[a].addClass(c)}},checkEmpty:function(){var a=this.list.getElements("tr");2===a.length&&this.addRow({label:Joomla.JText._("COM_FABRIK_NO_RECORDS")})},watchCheckAll:function(){var a,b,c=this.form.getElement("input[name=checkAll]");"null"!==typeOf(c)&&c.addEvent("click",function(c){var d=this.list.getParent(".fabrikList")?this.list.getParent(".fabrikList"):this.list,e=d.getElements("input[name^=ids]");for(a=c.target.checked?"checked":"",b=0;b<e.length;b++)e[b].checked=a,this.toggleJoinKeysChx(e[b])}.bind(this)),this.form.getElements("input[name^=ids]").each(function(a){a.addEvent("change",function(){this.toggleJoinKeysChx(a)}.bind(this))}.bind(this))},toggleJoinKeysChx:function(a){a.getParent().getElements("input[class=fabrik_joinedkey]").each(function(b){b.checked=a.checked})},watchNav:function(){var a,c;if(null!==this.form?(a=this.form.getElement("select[name*=limit]"),c=this.form.getElement(".addRecord")):(a=null,c=null),a&&a.addEvent("change",function(){b.fireEvent("fabrik.list.limit",[this]);return this.result===!1?(this.result=!0,!1):void this.doFilter()}.bind(this)),"null"!==typeOf(c)&&this.options.ajax_links){c.removeEvents();var d=""===this.options.links.add||c.href.contains(b.liveSite)?"xhr":"iframe",e=c.href;e+=e.contains("?")?"&":"?",e+="tmpl=component&ajax=1",c.addEvent("click",function(a){a.stop();var c={id:"add."+this.id,title:this.options.popup_add_label,loadMethod:d,contentURL:e,width:this.options.popup_width,height:this.options.popup_height};"null"!==typeOf(this.options.popup_offset_x)&&(c.offset_x=this.options.popup_offset_x),"null"!==typeOf(this.options.popup_offset_y)&&(c.offset_y=this.options.popup_offset_y),b.getWindow(c)}.bind(this))}if(document.id("fabrik__swaptable")&&document.id("fabrik__swaptable").addEvent("change",function(a){window.location="index.php?option=com_fabrik&task=list.view&cid="+a.target.get("value")}.bind(this)),"null"!==typeOf(this.form.getElement(".pagination"))){var f=this.form.getElement(".pagination").getElements(".pagenav");0===f.length&&(f=this.form.getElement(".pagination").getElements("a")),f.each(function(a){a.addEvent("click",function(b){if(b.stop(),"a"===a.get("tag")){var c=a.href.toObject();this.fabrikNav(c["limitstart"+this.id])}}.bind(this))}.bind(this))}this.watchCheckAll()},updateCals:function(a){var b=["sums","avgs","count","medians"];this.form.getElements(".fabrik_calculations").each(function(c){b.each(function(b){$H(a[b]).each(function(a,b){var d=c.getElement("."+b);"null"!==typeOf(d)&&d.set("html",a)})})})}});return g});