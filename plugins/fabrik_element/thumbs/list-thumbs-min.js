var FbThumbsList=new Class({options:{imageover:"",imageout:"",userid:"",formid:0},Implements:[Events,Options],initialize:function(b,a){this.setOptions(a);this.col=document.getElements("."+b);this.origThumbUp={};this.origThumbDown={};if(Fabrik.bootstrapped){this.setUpBootstrapped()}else{this.col.each(function(e){var f=e.getParent(".fabrik_row");if(f){var d=f.id.replace("list_"+this.options.renderContext+"_row_","");var c=e.getElements(".thumbup");var g=e.getElements(".thumbdown");c.each(function(h){h.addEvent("mouseover",function(i){h.setStyle("cursor","pointer");h.src=this.options.imagepath+"thumb_up_in.gif"}.bind(this));h.addEvent("mouseout",function(i){h.setStyle("cursor","");if(this.options.myThumbs[d]==="up"){h.src=this.options.imagepath+"thumb_up_in.gif"}else{h.src=this.options.imagepath+"thumb_up_out.gif"}}.bind(this));h.addEvent("click",function(i){this.doAjax(h,"up")}.bind(this))}.bind(this));g.each(function(h){h.addEvent("mouseover",function(i){h.setStyle("cursor","pointer");h.src=this.options.imagepath+"thumb_down_in.gif"}.bind(this));h.addEvent("mouseout",function(i){h.setStyle("cursor","");if(this.options.myThumbs[d]==="down"){h.src=this.options.imagepath+"thumb_down_in.gif"}else{h.src=this.options.imagepath+"thumb_down_out.gif"}}.bind(this));h.addEvent("click",function(i){this.doAjax(h,"down")}.bind(this))}.bind(this))}}.bind(this))}},setUpBootstrapped:function(){this.col.each(function(e){var c=e.getParent(".fabrik_row");if(c){var b=c.id.replace("list_"+this.options.renderContext+"_row_","");var a=e.getElement("button.thumb-up"),d=e.getElement("button.thumb-down");a.addEvent("click",function(g){g.stop();var f=a.hasClass("btn-success")?false:true;this.doAjax(e,"up",f);if(!f){a.removeClass("btn-success")}else{a.addClass("btn-success");if(typeOf(d)!=="null"){d.removeClass("btn-danger")}}}.bind(this));if(typeOf(d)!=="null"){d.addEvent("click",function(g){g.stop();var f=d.hasClass("btn-danger")?false:true;this.doAjax(e,"down",f);if(!f){d.removeClass("btn-danger")}else{d.addClass("btn-danger");a.removeClass("btn-success")}}.bind(this))}}}.bind(this))},doAjax:function(g,a,f){f=f?true:false;var h=g.getParent(".fabrik_row");var b=h.id.replace("list_"+this.options.renderContext+"_row_","");var d=document.id("count_thumb"+a+b);Fabrik.loader.start(h);this.thumb=a;var c={option:"com_fabrik",format:"raw",task:"plugin.pluginAjax",plugin:"thumbs",method:"ajax_rate",g:"element",element_id:this.options.elid,row_id:b,elementname:this.options.elid,userid:this.options.userid,thumb:this.thumb,listid:this.options.listid,formid:this.options.formid,add:f};new Request({url:"",data:c,onComplete:function(j){var i=document.id("count_thumbup"+b);var k=document.id("count_thumbdown"+b);var e=h.getElements(".thumbup");var l=h.getElements(".thumbdown");Fabrik.loader.stop(h);j=JSON.decode(j);if(j.error){console.log(j.error)}else{if(Fabrik.bootstrapped){h.getElement("button.thumb-up .thumb-count").set("text",j[0]);if(typeOf(h.getElement("button.thumb-down"))!=="null"){h.getElement("button.thumb-down .thumb-count").set("text",j[1])}}else{i.set("html",j[0]);k.set("html",j[1])}}}.bind(this)}).send()}});