var FbThumbs=new Class({Extends:FbElement,initialize:function(c,b,a){this.field=document.id(c);this.imagepath=Fabrik.liveSite+"plugins/fabrik_element/thumbs/images/";this.parent(c,b);this.element=document.id(c+"_div");this.thumb=a;this.spinner=new Asset.image(Fabrik.liveSite+"media/com_fabrik/images/ajax-loader.gif",{alt:"loading","class":"ajax-loader"});this.thumbup=document.id("thumbup");this.thumbdown=document.id("thumbdown");this.thumbup.addEvent("mouseover",function(d){this.thumbup.setStyle("cursor","pointer");this.thumbup.src=this.imagepath+"thumb_up_in.gif"}.bind(this));this.thumbdown.addEvent("mouseover",function(d){this.thumbdown.setStyle("cursor","pointer");this.thumbdown.src=this.imagepath+"thumb_down_in.gif"}.bind(this));this.thumbup.addEvent("mouseout",function(d){this.thumbup.setStyle("cursor","");if(this.options.myThumb==="up"){this.thumbup.src=this.imagepath+"thumb_up_in.gif"}else{this.thumbup.src=this.imagepath+"thumb_up_out.gif"}}.bind(this));this.thumbdown.addEvent("mouseout",function(d){this.thumbdown.setStyle("cursor","");if(this.options.myThumb==="down"){this.thumbdown.src=this.imagepath+"thumb_down_in.gif"}else{this.thumbdown.src=this.imagepath+"thumb_down_out.gif"}}.bind(this));this.thumbup.addEvent("click",function(d){this.doAjax("up")}.bind(this));this.thumbdown.addEvent("click",function(d){this.doAjax("down")}.bind(this))},doAjax:function(c){if(this.options.editable===false){var b=document.id("count_thumb"+c);this.spinner.inject(b);var d={row_id:this.options.row_id,elementname:this.options.elid,userid:this.options.userid,thumb:c,listid:this.options.listid};var a=Fabrik.liveSite+"index.php?option=com_fabrik&format=raw&view=plugin&task=pluginAjax&g=element&plugin=thumbs&method=ajax_rate&element_id="+this.options.elid+"&thumb="+c;new Request({url:a,data:d,onComplete:function(g){g=JSON.decode(g);this.spinner.dispose();if(g.error){console.log(g.error)}else{if(g!==""){var f=document.id("count_thumbup");var h=document.id("count_thumbdown");var e=document.id("thumbup");var i=document.id("thumbdown");f.set("html",g[0]);h.set("html",g[1]);document.id(this.element.id).getElement("."+this.field.id).value=g[0].toFloat()-g[1].toFloat();if(g[0]===1){e.src=this.imagepath+"thumb_up_in.gif";i.src=this.imagepath+"thumb_down_out.gif"}else{e.src=this.imagepath+"thumb_up_out.gif";i.src=this.imagepath+"thumb_down_in.gif"}}}}.bind(this)}).send()}}});