/*! fabrik */
UpdateColSelect=new Class({initialize:function(){this.updates={}},addFilter:function(a,b){this.updates[a]||(this.updates[a]=[]),this.updates[a].push(b)},onSumbit:function(){this.updates.date&&this.updates.date.each(function(a){a.onSubmit()})}});var FbListUpdateCol=new Class({Extends:FbListPlugin,initialize:function(a){this.parent(a),this.options.userSelect&&(Fabrik["filter_update_col"+this.options.ref]=new UpdateColSelect,this.makeUpdateColWindow())},buttonAction:function(){this.options.userSelect?this.win.open():this.list.submit("list.doPlugin")},makeUpdateColWindow:function(){this.windowopts={id:"update_col_win_"+this.options.ref,title:Joomla.JText._("PLG_LIST_UPDATE_COL_UPDATE"),loadMethod:"html",content:this.options.form,width:400,destroy:!1,height:300,onOpen:function(){this.fitToContent(!1)},onContentLoaded:function(a){var b=document.id("update_col"+this.options.ref);b.addEvent("click:relay(a.add)",function(a,c){a.preventDefault();var d,e=c.getParent("thead");d=e?b.getElements("tbody tr").getLast():c.getParent("tr"),"none"===d.getStyle("display")?d.show():d.clone().inject(d,"after")}),b.addEvent("click:relay(a.delete)",function(a,c){a.preventDefault();var d=b.getElements("tbody tr");1===d.length?d.getLast().hide():c.getParent("tr").destroy()}),b.addEvent("change:relay(select.key)",function(b,c){var d=c.options[c.selectedIndex],e=c.getParent("tr");Fabrik.loader.start(e);var f=e.getElement("td.update_col_value"),g=c.get("value"),h=d.get("data-plugin"),i=d.get("data-id"),j=0,k="index.php?option=com_fabrik&task=list.elementFilter&format=raw";new Request.HTML({url:k,update:f,data:{element:g,id:this.options.listid,elid:i,plugin:h,counter:j,listref:this.options.ref,context:"visualization",parentView:"update_col"+this.options.ref,fabrikIngoreDefaultFilterVal:1},onComplete:function(){Fabrik.loader.stop(e),a.fitToContent(!1)}}).send()}.bind(this)),b.getElement("input[type=button]").addEvent("click",function(a){a.stop();var c;Fabrik["filter_update_col"+this.options.ref].onSumbit();var d=document.id("listform_"+this.options.ref);c=new Element("input",{type:"hidden",value:b.toQueryString(),name:"fabrik_update_col"}),c.inject(d,"bottom"),this.list.submit("list.doPlugin")}.bind(this))}.bind(this)},this.win=Fabrik.getWindow(this.windowopts),this.win.close()}});