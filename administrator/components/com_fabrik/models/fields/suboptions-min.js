var Suboptions=new Class({Implements:[Options],options:{sub_initial_selection:[],defaultMax:0},initialize:function(a,b){this.setOptions(b),this.element=document.id(this.options.id),"null"===typeOf(this.element)&&confirm("oh dear - somethings gone wrong with loading the sub-options, do you want to reload?")&&location.reload(!0),this.watchButtons(),this.watchDefaultCheckboxes(),this.counter=0,this.name=a,Object.each(this.options.sub_values,(function(a,b){var c=Object.contains(this.options.sub_initial_selection,a)?"checked='checked'":"";this.addSubElement(a,this.options.sub_labels[b],c)}).bind(this)),0===this.options.sub_values.length&&this.addSubElement("","",!1),Joomla.submitbutton=(function(a){if("element.cancel"!==a&&!this.onSave())return!1;Joomla.submitform(a)}).bind(this)},watchDefaultCheckboxes:function(){this.element.addEvent("click:relay(input.sub_initial_selection)",(function(a){1===this.options.defaultMax&&this.element.getElements("input.sub_initial_selection").each(function(b){b!==a.target&&(b.checked=!1)})}).bind(this))},watchButtons:function(){this.element.addEvent('click:relay(a[data-button="addSuboption"])',(function(a){a.preventDefault(),this.addSubElement()}).bind(this)),this.element.addEvent('click:relay(a[data-button="deleteSuboption"])',(function(a,b){a.preventDefault(),this.element.getElements("tbody tr").length>1&&b.getParent("tr").dispose()}).bind(this)),this.element.getElements('a[data-button="addSuboption"]')},addOption:function(a){this.addSubElement(),a.stop()},removeSubElement:function(a){var b=a.target.id.replace("sub_delete_","");document.id("sub_subElementBody").getElements("li").length>1&&document.id("sub_content_"+b).dispose(),a.stop()},addJ3SubElement:function(a,d,e){var f=this._chx(a,e),g=this._deleteButton(),b=new Element("tr").adopt([new Element("td",{class:"handle subhandle"}),new Element("td",{width:"30%"}).adopt(this._valueField(a)),new Element("td",{width:"30%"}).adopt(this._labelField(d)),new Element("td",{width:"10%"}).set("html",f),g]),c=this.element.getElement("tbody");c.adopt(b),this.sortable?this.sortable.addItems(b):this.sortable=new Sortables(c,{handle:".subhandle"}),this.counter++},_valueField:function(a){return new Element("input",{class:"form-control-sm inputbox sub_values",type:"text",name:this.name+"[sub_values][]",id:"sub_value_"+this.counter,size:20,value:a,events:{change:function(a){fconsole("need to set this chb boxes value to the value field if selected, or set to blank")}}})},_labelField:function(a){return new Element("input",{class:"form-control-sm inputbox sub_labels",type:"text",name:this.name+"[sub_labels][]",id:"sub_text_"+this.counter,size:20,value:a})},_chx:function(a,b){return'<input class="form-check inputbox sub_initial_selection" type="checkbox" value="'+a+"\" name='"+this.name+"[sub_initial_selection][]' id=\"sub_checked_"+this.counter+'" '+b+" />"},_deleteButton:function(){return new Element("td",{width:"20%"}).set("html",this.options.delButton)},addSubElement:function(a,b,c){return this.addJ3SubElement(a,b,c)},onSave:function(){var c=[],a=document.id("jform_params_dropdown_populate"),b=!1;return"null"!==typeOf(a)&&""!==a.get("value")&&(b=!0),b||$$(".sub_values").each(function(a){c.push(a.value)}),$$(".sub_initial_selection").each(function(a,b){a.value=c[b]}),!0}})