var PluginManager=new Class({initialize:function(a){this.plugins=a;this.counter=0;this.opts=this.opts||{};this.deletePluginClick=this.deletePlugin.bindWithEvent(this);this.watchAdd()},_makeSel:function(h,d,g,f){var b,a;var e=[];this.sel=f;e.push(new Element("option",{value:""}).appendText(Joomla.JText._("COM_FABRIK_PLEASE_SELECT")));g.each(function(c){if(typeOf(c)==="object"){b=c.value?c.value:c.name;a=c.label?c.label:b}else{b=a=c}if(b===this.sel){e.push(new Element("option",{value:b,selected:"selected"}).set("text",a))}else{e.push(new Element("option",{value:b}).set("text",a))}}.bind(this));return new Element("select",{"class":h,name:d}).adopt(e)},addPlugin:function(a){this.plugins.push(a)},deletePlugin:function(a){a.stop();$(a.target).up(3).dispose();this.counter--},watchAdd:function(){$("addPlugin").addEvent("click",function(a){a.stop();this.addAction("","","","")}.bind(this))},watchDelete:function(){$("plugins").getElements(".delete").each(function(a){a.removeEvents("click");a.addEvent("click",this.deletePluginClick)}.bind(this))},getPluginTop:function(){return""},addAction:function(f,d,e,h,k){k=k===false?false:true;var b=new Element("td");var j="";this.plugins.each(function(c){if(c.name===d){j+=f}else{j+=c.options.html}}.bind(this));j=j.replace(/\[0\]/gi,"["+this.counter+"]");b.innerHTML=j;var g="block";var i=new Element("div",{"class":"actionContainer"}).adopt(new Element("table",{"class":"adminform",id:"formAction_"+this.counter,styles:{display:g}}).adopt(new Element("tbody",{styles:{width:"100%"}}).adopt([this.getPluginTop(d,e,h),new Element("tr").adopt(b),new Element("tr").adopt(new Element("td",{}).adopt(new Element("a",{href:"#","class":"delete removeButton"}).appendText(Joomla.JText._("COM_FABRIK_DELETE"))))])));i.inject($("plugins"));if(this.counter!==0){i.getElements("input[name^=params]","select[name^=params]").each(function(n){if(n.id!==""){var c=n.id.split("-");c.pop();n.id=c.join("-")+"-"+this.counter}}.bind(this));i.getElements("img[src=components/com_fabrik/images/ajax-loader.gif]").each(function(c){c.id=c.id.replace("-0_loader","-"+this.counter+"_loader")}.bind(this));if(k===true){this.plugins.each(function(c){var n=new CloneObject(c,true,[]);n.cloned(this.counter)}.bind(this))}}var m=$("formAction_"+this.counter);m.getElements("."+this.opts.type+"Settings").hide();var a=m.getElement(" .page-"+d);if(a){a.show()}m.getElement(".elementtype").addEvent("change",function(n){n.stop();var o=$(n.target).up(3).id.replace("formAction_","");$("formAction_"+o).getElements("."+this.opts.type+"Settings").hide();var c=$(n.target).get("value");if(c!==Joomla.JText._("COM_FABRIK_PLEASE_SELECT")&&c!==""){$("formAction_"+o).getElement(".page-"+c).show()}}.bind(this));this.watchDelete();var l=new Tips($$("#formAction_"+this.counter+" .hasTip"),{});this.counter++}});fabrikAdminPlugin=new Class({Implements:[Options],options:{},initialize:function(c,b,a){this.name=c;this.label=b;this.setOptions(a)},cloned:function(){}});