define(["jquery"],function(a){return new Class({Implements:[Options],initialize:function(a,b,c){this.el=document.id(a),this.fields=b,this.setOptions(c),this.filters=[],this.counter=0},addHeadings:function(){new Element("thead").adopt(new Element("tr",{id:"filterTh",class:"title"}).adopt(new Element("th").set("text",Joomla.JText._("COM_FABRIK_JOIN")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_FIELD")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_CONDITION")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_VALUE")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_TYPE")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_APPLY_FILTER_TO")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_GROUPED")),new Element("th").set("text",Joomla.JText._("COM_FABRIK_DELETE")))).inject(document.id("filterContainer"),"before")},deleteFilterOption:function(a){var c,b;this.counter--,a.stop(),a.target.id.replace("filterContainer-del-","").toInt(),b=a.target.getParent("tr"),c=a.target.getParent("table"),0===this.counter&&c.hide(),b.getElements("input, select, textarea").dispose(),b.hide()},_makeSel:function(c,d,e,f,a){var b=[];return(a=!0===a)&&b.push(new Element("option",{value:""}).set("text",Joomla.JText._("COM_FABRIK_PLEASE_SELECT"))),e.each(function(a){a.value===f?b.push(new Element("option",{value:a.value,selected:"selected"}).set("text",a.label)):b.push(new Element("option",{value:a.value}).set("text",a.label))}),new Element("select",{class:c,name:d}).adopt(b)},addFilterOption:function(e,i,j,m,k,y,f){this.counter<=0&&(this.el.getParent("table").getElement("thead")||this.addHeadings()),e=e||"",i=i||"",j=j||"",m=m||"",k=k||"",f=f||"";var n,o,p,a,b,z=this.options.filterCondDd,c=new Element("tr");if(0===this.counter?p=new Element("span").set("text","WHERE").adopt(new Element("input",{type:"hidden",id:"paramsfilter-join",class:"form-control inputbox",name:"jform[params][filter-join][]",value:e})):("AND"===e?(n=new Element("option",{value:"AND",selected:"selected"}).set("text","AND"),o=new Element("option",{value:"OR"}).set("text","OR")):(n=new Element("option",{value:"AND"}).set("text","AND"),o=new Element("option",{value:"OR",selected:"selected"}).set("text","OR")),p=new Element("select",{id:"paramsfilter-join",class:"form-select-sm inputbox input-small",name:"jform[params][filter-join][]"}).adopt([n,o])),this.counter<=0){var l=new Element("td");l.appendChild(new Element("input",{type:"hidden",name:"jform[params][filter-grouped]["+this.counter+"]",value:"0"})),l.appendChild(new Element("span").set("text","n/a"))}else{var g="jform_params_filter-grouped_"+this.counter,v="jform[params][filter-grouped]["+this.counter+"]",h=new Element("fieldset",{class:"btn-group radio",id:g}),d={id:g+"_0",type:"radio",name:v,value:"0"};d.checked="1"!==f?"checked":"",h.appendChild(new Element("input",d)),d={for:g+"_0",class:"btn"+("1"!==f?" active":"")},h.appendChild(new Element("label",d).set("text",Joomla.JText._("JNO"))),(d={id:g+"_1",type:"radio",name:v,value:"1"}).checked="1"===f?"checked":"",h.appendChild(new Element("input",d)),d={for:g+"_1",class:"btn"+("1"===f?" active":"")},h.appendChild(new Element("label",d).set("text",Joomla.JText._("JYES")));var l=new Element("td").adopt(h)}var q=new Element("td");q.appendChild(p);var r=new Element("td");r.innerHTML=this.fields;var s=new Element("td");s.innerHTML=z;var t=new Element("td"),u=new Element("td");u.innerHTML=this.options.filterAccess;var w=new Element("td"),A=new Element("textarea",{name:"jform[params][filter-value][]",class:"form-control inputbox",cols:17,rows:2}).set("text",m);t.appendChild(A),t.appendChild(new Element("br"));var B=[{value:0,label:Joomla.JText._("COM_FABRIK_TEXT")},{value:1,label:Joomla.JText._("COM_FABRIK_EVAL")},{value:2,label:Joomla.JText._("COM_FABRIK_QUERY")},{value:3,label:Joomla.JText._("COM_FABRIK_NO_QUOTES")}],C=new Element("td").adopt(this._makeSel("form-select-sm inputbox elementtype input-small","jform[params][filter-eval][]",B,y,!1)),x=this.el.id+"-del-"+this.counter;if(w.set("html",'<button id="'+x+'" class="btn btn-danger btn-sm"><i class="icon-minus" style="margin:0"></i></button>'),c.appendChild(q),c.appendChild(r),c.appendChild(s),c.appendChild(t),c.appendChild(C),c.appendChild(u),c.appendChild(l),c.appendChild(w),this.el.appendChild(c),this.el.getParent("table").show(),document.id(x).addEvent("click",(function(a){this.deleteFilterOption(a)}).bind(this)),document.id(this.el.id+"-del-"+this.counter).click=(function(a){this.deleteFilterOption(a)}).bind(this),""!==e&&(b=Array.mfrom(q.getElementsByTagName("SELECT"))).length>=1)for(a=0;a<b[0].length;a++)b[0][a].value===e&&(b[0].options.selectedIndex=a);if(""!==i&&(b=Array.mfrom(r.getElementsByTagName("SELECT"))).length>=1)for(a=0;a<b[0].length;a++)b[0][a].value===i&&(b[0].options.selectedIndex=a);if(""!==j&&(b=Array.mfrom(s.getElementsByTagName("SELECT"))).length>=1)for(a=0;a<b[0].length;a++)b[0][a].value===j&&(b[0].options.selectedIndex=a);if(""!==k&&(b=Array.mfrom(u.getElementsByTagName("SELECT"))).length>=1)for(a=0;a<b[0].length;a++)b[0][a].value===k&&(b[0].options.selectedIndex=a);this.counter++}})})